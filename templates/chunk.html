{% extends "base.html" %}

{% block head %}
<script type="text/javascript">
function nochunksize()
{
	if (document.getElementById('chunksize').value == '' && document.getElementById('chunknumber').value == '')
	{
		alert('Please enter a chunk size or a number of chunks.')
		return false;
	}
}
function hidechunkoption(num) {

    switch(num)
    {
    	case 1:
    		var show = document.getElementById("chunksize");
    		var hide = document.getElementById("chunknumber");
    		break;
    	case 2:
    		var hide = document.getElementById("chunksize");
    		var show = document.getElementById("chunknumber");
    		break;
    }
    hide.disabled = true;
    hide.value = "";
    show.disabled = false;

    var proportion = document.getElementById("lastprop");
    proportion.disabled ? (proportion.disabled = false, proportion.value = '50') : (proportion.disabled = true, proportion.value = '');
}
</script>
{% endblock %}

{% block title %}chunker{% endblock %}
{% block field %}
<legend>Chunking Options</legend>
<form id="scrub" action="" method="POST" enctype="multipart/form-data">
<label>Split by:</label>
<input type="radio" name="chunkoption" value="size" checked onClick="hidechunkoption(1);">Chunk Size
<input type="radio" name="chunkoption" value="number" onClick="hidechunkoption(2);">Number of Chunks
<p><label>Chunk Size:</label> <input name="chunksize" id="chunksize" type="text" size="12"/> (# of words per chunk)</p>
<p><label>Number of Chunks:</label> <input name="chunknumber" id="chunknumber" type="text" size="12" disabled/></p>
<p><label>Overlap:</label> <input name="overlap" type="text" size="12" value="0"/> (# of words overlapping at chunk boundaries)</p>
<p><label>Last Proportion:</label> <input name="lastprop" id="lastprop" type="text" size="3" value="50"/>% (The proportion of chunksize the last chunk can be)</p>
{% endblock %}

{% block content %}

{% for fn, f in session['preview'].items() | sort %}
<fieldset>
<legend>{{fn}} Preview</legend>
{% if session['chunked'] %}
{% for index, preview in f.items() %}
{% if loop.index==6 and index > 5 %}
<p></p>
{% endif %}
<fieldset>
<legend>Chunk {{index+1}}</legend>
{{preview}}
</fieldset>
{%- endfor %}
{% else %}
{{f}}
{% endif %}
</fieldset>
{%- endfor %}

{% endblock %}

{% block submit %}<input type="submit" value="Cut Files" onSubmit="return nochunksize();"/>
{% if session['chunked'] %}
<input type="submit" name="dendro" value="Proceed to Analysis"/>
{% endif %}
{% endblock %}