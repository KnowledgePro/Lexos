{% extends "base.html" %}

{% block head %}
<script type="text/javascript" src="{{ url_for('static', filename='scripts_scrub.js') }}"></script>
{% endblock %}

{% block title %}scrubber{% endblock %}
{% block field %}

<fieldset id="normalscrubbingoptions">
<legend>Scrubbing Options</legend>
<form id="scrub" action="" method="POST" enctype="multipart/form-data">

<input type="hidden" id="usecacheswfileselect" name="usecacheswfileselect" value="" {{ 'disabled' if session['opt_uploads']['swfileselect[]'] == '' else '' }}/>
<input type="hidden" id="usecachelemfileselect" name="usecachelemfileselect" value="" {{ 'disabled' if session['opt_uploads']['lemfileselect[]'] == '' else '' }}/>
<input type="hidden" id="usecacheconsfileselect" name="usecacheconsfileselect" value="" {{ 'disabled' if session['opt_uploads']['consfileselect[]'] == '' else '' }}/>
<input type="hidden" id="usecachescfileselect" name="usecachescfileselect" value="" {{ 'disabled' if session['opt_uploads']['scfileselect[]'] == '' else '' }}/>

<div>
	<div class="leftfloat">
		<label class="checkbox" id="punctbox">
		    <input type="checkbox" name="punctuationbox" {{"checked" if request.form['punctuationbox'] else ""}} data-toggle="checkbox">
		    Remove Punctuation
		</label>
		<label class="checkbox" for="lowercasebox">
	        <input type="checkbox" name="lowercasebox" {{"checked" if request.form['lowercasebox'] else ""}} data-toggle="checkbox">
	        Make Lowercase
	    </label>
    	<label class="checkbox" for="digitsbox">
            <input type="checkbox" name="digitsbox" {{"checked" if request.form['digitsbox'] else ""}} data-toggle="checkbox">
            Remove Digits
        </label>
    </div>
    <div class="leftfloat" style="{{ '' if request.form['punctuationbox'] else 'display:none' }}" id="aposhyph">
		<label class="checkbox" for="aposbox">
            <input type="checkbox" name="aposbox" {{"checked" if request.form['aposbox'] else ""}} data-toggle="checkbox">
            Keep Apostrophes
        </label>
		<label class="checkbox" for="hyphensbox">
            <input type="checkbox" name="hyphensbox"  {{"checked" if request.form['hyphensbox'] else ""}} data-toggle="checkbox">
            Keep Hyphens
        </label>
    </div>
</div>

<div style="display: {{ '' if session['hastags'] else 'none' }}; float:left">
	<label>Your text(s) contain tags. Would you like to:
		<label class="radio" id="tagsradio">
			<input type="radio" name="tags" value="keep" {{"checked" if session['keeptags'] == True else ""}} data-toggle="radio"/>&nbsp;&nbsp;&nbsp;Keep Words Between Tags
		</label>
		<label class="radio">
			<input type="radio" name="tags" value="discard" {{"checked" if session['keeptags'] == False else ""}} data-toggle="radio" />&nbsp;&nbsp;&nbsp;Discard Words Between Tags
		</label>
	</label>
</div>
</fieldset>

<fieldset id="additionalscrubbingoptions">
<legend>Optional Uploads</legend>

<div>
	<div>
		<input type="file" class="hiddenfileselect" id="swfileselect" name="swfileselect[]" />
		<div class= "bttn optionbttn" id="stopwords">Stopwords</div>
		<div class="questionmark large"></div>
		<div class="tooltip scrub general">Click to specify stopwords (words to be removed)</div>

		<div id="stopwordinput" style="{{ 'display:none' if session['opt_uploads']['swfileselect[]'] == '' and not request.form['manualstopwords'] else '' }}">
			<textarea class="manualinput" name="manualstopwords" placeholder="Enter stopwords..." >{{ request.form['manualstopwords'] }}</textarea>
			<div class="questionmark small"></div>

  		<div class="tooltip scrub format">Enter a stopword list separated by a comma; Or click on "Upload File" to upload a stopword list txt file (with the same format described above). </div>

			/

			<div class="inlineblock">
				<div class="bttnfilelabels" id="swfileselectbttnlabel">
					{{ session['opt_uploads']['swfileselect[]'] + '(using cached)' if session['opt_uploads']['swfileselect[]'] != '' }} 
				</div>
  			<div class="tooltip scrub general">Click to disable</div>
				<div class="bttn uploadbttn" id="prettystopwordsupload">Upload File</div>
			</div>
		</div>
	</div>

	<div>
		<input type="file" class="hiddenfileselect" id="lemfileselect" name="lemfileselect[]"/>
		<div class= "bttn optionbttn" id="lemmas">Lemmas</div>
		<div class="questionmark large"></div>
  	<div class="tooltip scrub general">Click to specify lemmas&nbsp;&nbsp; (word replacements)</div>

		<div id="lemmainput" style="{{ 'display:none' if session['opt_uploads']['lemfileselect[]'] == '' and not request.form['manuallemmas'] else '' }}">
			<textarea class="manualinput" name="manuallemmas" placeholder="Enter lemmas..." >{{ request.form['manuallemmas'] }}</textarea>
			<div class="questionmark small"></div>

  		<div class="tooltip scrub format">Enter a lemma list. Each line should contain a comma-separated list with a lemma followed by the word(s) need to be replaced (e.g.: "sing, sang, sung" will replace "sang" and "sung" with "sing"); Or click on "Upload File" to upload a lemma list txt file (with same format described above). </div>

			/

			<div class="inlineblock">
				<div class="bttnfilelabels" id="lemfileselectbttnlabel">
					{{ session['opt_uploads']['lemfileselect[]'] + '(using cached)' if session['opt_uploads']['lemfileselect[]'] != '' }}
				</div>
  			<div class="tooltip scrub general">Click to disable</div>
				<div class="bttn uploadbttn" id="prettylemmasupload">Upload File</div>
			</div>
		</div>
	</div>

	<div>
		<input type="file" class="hiddenfileselect" id="consfileselect" name="consfileselect[]"/>
		<div class= "bttn optionbttn" id="consolidations">Consolidations</div> 
		<div class="questionmark large"></div>
  	<div class="tooltip scrub general">Click to specify consolidations (character replacements)</div>

		<div id="consolidationsinput" style="{{ 'display:none' if session['opt_uploads']['consfileselect[]'] == '' and not request.form['manualconsolidations'] else '' }}">
			<textarea class="manualinput" name="manualconsolidations" placeholder="Enter consolidations..." >{{ request.form['manualconsolidations'] }}</textarea>
			<div class="questionmark small"></div>

  		<div class="tooltip scrub format">Click to enter a consolidation list. Each line should contain a comma-separated list with character pattern followed by the value(s) need to be replaced (e.g.: 'a, aa, bb' will replace "aa" and "bb" with "a"); Or click on "Upload File" to upload a consolidation list txt file (with the same format described above).</div>

			/

			<div class="inlineblock">
				<div class="bttnfilelabels" id="consfileselectbttnlabel">
					{{ session['opt_uploads']['consfileselect[]'] + '(using cached)' if session['opt_uploads']['consfileselect[]'] != '' }}
				</div>
				<div class="bttn uploadbttn" id="prettyconsolidationsupload">Upload File</div>
			</div>
		</div>
	</div>

	<div>
		<input type="file" class="hiddenfileselect" id="scfileselect" name="scfileselect[]"/>
		<div class= "bttn optionbttn" id="specialchars">Special Characters</div> 
		<div class="questionmark large"></div>
  	<div class="tooltip scrub general">Click to specify special character handling</div>

		<div id="specialcharsinput" style="{{ 'display:none' if session['opt_uploads']['scfileselect[]'] == '' and not request.form['manualspecialchars'] else '' }}">

			<select id="entityrules" name="entityrules">
				<option value="default" {{ 'selected' if request.form['entityrules'] == 'default'}}>Default</option>
				<option value="doe-sgml" {{ 'selected' if request.form['entityrules'] == 'doe-sgml'}}>Dictionary of Old English SGML</option>
				<option value="early-english-html"  {{ 'selected' if request.form['entityrules'] == 'early-english-html' }}>Early English HTML</option>
			</select>

			<a href={{ url_for('static', filename='pre_defined_rules.html') }} target="_blank">View Pre-Defined Rule Sets</a>
			<div class="newline" id="specialchartext"><strong>or</strong></div>
			<textarea class="manualinput" name="manualspecialchars" placeholder="Enter special characters...">{{ request.form['manualspecialchars'] }}</textarea>
			<div class="questionmark small specchars"></div>

  		<div class="tooltip scrub format">Click to enter a list of rules for handling special characters. Each line should contain a comma-separated list with character pattern followed by the value(s) to be replaced (e.g. 'æ, b, c' will replace "b" and "c" with "æ"). Or click on "Upload File" to upload a special-character txt file (with the same format described above).</div> 
  		
			/

			<div class="inlineblock">
				<div class="bttnfilelabels" id="scfileselectbttnlabel">
					{{ session['opt_uploads']['scfileselect[]'] + '(using cached)' if session['opt_uploads']['scfileselect[]'] != '' }}
				</div>
				<div class="bttn uploadbttn" id="prettyspecialcharsupload">Upload File</div>
			</div>
		</div>
	</div>
</div>







</fieldset>
{% endblock %}


{% block submit %}
<div class="spacer"></div>
<input class="btn btn-info" type="submit" id="scrubsubmit" value="Preview Scrubbing"/>
{% if session['scrubbed'] %}
<input class="btn btn-success" type="submit" name="cut" value="Proceed to Cutting"/>
<input class="btn btn-inverse rightfloat" type="submit" name="download" value="Download Scrubbed Files"/>
<input class="btn" id="previewreload" type="submit" name="previewreload" value="Repair Previews"/>
{% endif %}
{% endblock %}



{% block content %}
{% for filename, file in preview.items() %}
<fieldset>
<legend>{{filename}} Preview</legend>
{{file}}{{"\u2026"}}
</fieldset>
{%- endfor %}

{% endblock %}
