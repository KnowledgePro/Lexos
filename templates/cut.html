{% extends "base.html" %}

{% block head %}
<script type="text/javascript" src="{{ url_for('static', filename='scripts_cut.js') }}"></script>
{% endblock %}

{% block title %}cutter{% endblock %}
{% block field %}
<legend>Overall Cutting Options</legend>
<form id="cut" action="" method="POST" enctype="multipart/form-data" onsubmit="return noslicesize();">

<div class="sliceoptionswrapper">
    <div style="float:left; margin-bottom: 20px">
        <label class="radio sizeradio" style="display:inline; margin-right:10px">
            <input type="radio" name="radio" value="size" {{ "checked" if session['cuttingOptionsLegend']['overall']['cuttingType'] == 'Size' }} data-toggle="radio">
            Slice Size
        </label>
        <label class="radio numberradio" style="display:inline">
            <input type="radio" name="radio" value="number" {{ "checked" if session['cuttingOptionsLegend']['overall']['cuttingType'] == 'Number' }} data-toggle="radio">
            Number of Slices
        </label>
    </div>


    <div style="clear:left; float:left">
        <div style="float:left">
            <div>
                <label class="slicingoptionlabel">{{ 'Slice Size' if session['cuttingOptionsLegend']['overall']['cuttingType'] == 'Size' else 'Number of Slices'}}:
                <input class="slicingValue" 
                style="width:100px"
                name="slicingValue" 
                id="overallCutValue"
                type="text" 
                value="{{ session['cuttingOptionsLegend']['overall']['slicingValue'] }}"/>
                <img src="{{ url_for('static', filename='question_mark.png') }}" 
                alt="Question Mark" 
                title="(Number of words per slice or number of slices per document)"/>
                </label>
            </div>
            <div>
                <label>Overlap:&nbsp;&nbsp;
                <input 
                style="width:100px"
                name="overlap" 
                type="text" 
                value="{{ session['cuttingOptionsLegend']['overall']['overlap'] }}"/>
                <img src="{{ url_for('static', filename='question_mark.png') }}"
                alt="Question Mark" 
                title="(Number of words overlapping at slice boundaries)"/>
                </label>
            </div>
        </div>
        <div style="float:left; margin-left:10px; margin-top:2px">
            <div class="lastproptableslot" style="{{ 'display:none' if session['cuttingOptionsLegend']['overall']['cuttingType'] == 'Number' else '' }}">
                <label>Last Proportion Threshold:
                <img src="{{ url_for('static', filename='question_mark.png') }}" 
                alt="Question Mark" 
                title="(The proportion of slicesize the last slice can be)"/>
                <br>
                <input {{ "disabled" if session['cuttingOptionsLegend']['overall']['cuttingType'] == 'Number' else "" }}
                style="width:60px;margin-left:50px"
                class="lastpropinput"
                name="lastprop"
                id="lastprop"
                type="text"
                value="{{ session['cuttingOptionsLegend']['overall']['lastProp'] }}"/>
                </label>
            </div>
        </div>
    </div>
</div>
{% endblock %}




{% block submit %}
<div style="height:15px"></div>
<input class="btn btn-info" type="submit" value="Cut Files"/>
{% if session['sliced'] %}
<input class="btn btn-success" type="submit" name="dendro" value="Proceed to Analysis"/>
{% endif %}
{% endblock %}




{% block content %}

{% for filename, file in preview.items() | sort %}
<div class="individualpreviewwrapper">

<legend>{{filename}} Preview &nbsp;
<input class="btn btn-info indivcutbuttons" style="padding:2px 2px 2px" type="button" value="Cut"/>
</legend>

<div class="sliceoptionswrapper" style="display:none">

    <div style="float:left; margin-bottom: 20px">
        <label class="radio sizeradio" style="display:inline; margin-right:10px">
            <input type="radio" name="radio{{ session['paths'].keys().index(filename) }}" value="size" {{ "checked" if session['cuttingOptionsLegend']['overall']['cuttingType'] == 'Size' }} data-toggle="radio">
            Slice Size
        </label>
        <label class="radio numberradio" style="display:inline">
            <input type="radio" name="radio{{ session['paths'].keys().index(filename) }}" value="number" {{ "checked" if session['cuttingOptionsLegend']['overall']['cuttingType'] == 'Number' }} data-toggle="radio">
            Number of Slices
        </label>
    </div>
    <div style="clear:left; float:left">
        <div style="float:left">
            <div>
                <label class="slicingoptionlabel">{{ 'Slice Size' if session['cuttingOptionsLegend']['overall']['cuttingType'] == 'Size' else 'Number of Slices'}}:
                <input class="slicingValue" 
                style="width:100px"
                name="slicingValue{{ session['paths'].keys().index(filename) }}" 
                id="overallCutValue"
                type="text" 
                value="{{ session['cuttingOptionsLegend'][filename]['slicingValue'] }}"/>
                <img src="{{ url_for('static', filename='question_mark.png') }}" 
                alt="Question Mark" 
                title="(Number of words per slice or number of slices per document)"/>
                </label>
            </div>
            <div>
                <label>Overlap:&nbsp;&nbsp;
                <input 
                style="width:100px"
                name="overlap{{ session['paths'].keys().index(filename) }}" 
                type="text" 
                value="{{ session['cuttingOptionsLegend'][filename]['overlap'] }}"/>
                <img src="{{ url_for('static', filename='question_mark.png') }}"
                alt="Question Mark" 
                title="(Number of words overlapping at slice boundaries)"/>
                </label>
            </div>
        </div>
        <div style="float:left; margin-left:10px; margin-top:2px">
            <div class="lastproptableslot" style="{{ 'display:none' if session['cuttingOptionsLegend']['overall']['cuttingType'] == 'Number' else '' }}">
                <label>Last Proportion Threshold:
                <img src="{{ url_for('static', filename='question_mark.png') }}" 
                alt="Question Mark" 
                title="(The proportion of slicesize the last slice can be)"/>
                <br>
                <input {{ "disabled" if session['cuttingOptionsLegend']['overall']['cuttingType'] == 'Number' else "" }}
                style="width:60px;margin-left:50px"
                class="lastpropinput"
                name="lastprop{{ session['paths'].keys().index(filename) }}"
                id="lastprop"
                type="text"
                value="{{ session['cuttingOptionsLegend'][filename]['lastProp'] }}"/>
                </label>
            </div>
        </div>
    </div>

</div>

<div style="clear:both">
    {% if session['sliced'] %}
        {% for index, cutpreview in file.items() %}
            {% if loop.index==6 and index > 5 %}
                <p></p>
            {% endif %}

            <fieldset>
            <legend>Slice {{index+1}}</legend>
            {{cutpreview}}
            </fieldset>

        {%- endfor %}

    {% else %}
        {{file}}
    {% endif %}
</div>

</div>

{%- endfor %}
{% endblock %}