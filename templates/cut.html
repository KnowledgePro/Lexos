{% extends "base.html" %}

{% block head %}
<script type="text/javascript" src="{{ url_for('static', filename='scripts_cut.js') }}"></script>
{% endblock %}

{% block title %}cutter{% endblock %}
{% block field %}
<legend>Overall Cutting Options</legend>
<form id="cut" action="" method="POST" enctype="multipart/form-data" onsubmit="return nocuttingvalue();">

<div class="cuttingoptionswrapper">
  <div>
    <label class="radio sizeradio" id="sizeradio">
      <input type="radio" name="radio" value="size" {{ "checked" if cuttingOptions['overall']['cuttingType'] == 'Size' }} data-toggle="radio">
      Segment Size
    </label>
    <label class="radio numberradio" id="numberradio">
      <input type="radio" name="radio" value="number" {{ "checked" if cuttingOptions['overall']['cuttingType'] == 'Number' }} data-toggle="radio">
      Number of Segments
    </label>
  </div>


  <div class="cuttingdiv">
		<div id="cuttingsize">
			<label class="cuttingoptionslabel inline">{{ 'Segment Size' if cuttingOptions['overall']['cuttingType'] == 'Size' else 'Number of Segments'}}:</label>
			<input class="textinput cuttingValue cuttextinput" 
			name="cuttingValue" 
			id="overallcutvalue"
			type="text" 
			value="{{ cuttingOptions['overall']['cuttingValue'] }}"/>
			<!-- <img src="{{ url_for('static', filename='question_mark.png') }}" 
			alt="Question Mark" 
			title="Value to segment text by."/> -->
		</div>
		<div>
			<label class="inline">Overlap:</label>
			<input class="textinput cuttextinput"
			name="overlap" 
			type="text" 
			value="{{ cuttingOptions['overall']['overlap'] }}"/>
			<!--          <img src="{{ url_for('static', filename='question_mark.png') }}"
			alt="Question Mark" 
			title="Number of words to overlap at segment boundaries."/> -->
		</div>
		<div class="lastpropdiv" style="{{ 'opacity:0' if cuttingOptions['overall']['cuttingType'] == 'Number' else '' }}">
			<label class="inline">Last Proportion Threshold:</label>
			<!-- <img src="{{ url_for('static', filename='question_mark.png') }}" 
			alt="Question Mark" 
			title="Minimum proportion of the normal size that the last segment can be."/> -->
			<input {{ "disabled" if cuttingOptions['overall']['cuttingType'] == 'Number' else "" }}
			class="textinput lastpropinput"
			name="lastprop"
			id="lastprop"
			type="text"
			value="{{ cuttingOptions['overall']['lastProp'] }}"/>
		</div>
	</div>
</div>
{% endblock %}




{% block submit %}
<input class="btn btn-info" type="submit" value="Cut Files"/>
{% if session['segmented'] %}
<input class="btn btn-success" type="submit" name="dendro" value="Proceed to Analysis"/>
{% endif %}
{% endblock %}




{% block content %}
{% for filename, file in preview.items() | sort %}
<div class="individualpreviewwrapper">

<legend>{{filename}} Preview &nbsp;
<input class="btn indivcutbuttons" type="button" value="Individual Options"/>
</legend>

<div class="cuttingoptionswrapper" style="{{ 'display:none' if cuttingOptions[filename]['cuttingValue'] == '' }}">

	<div>
		<label class="radio sizeradio">
			<input type="radio" name="radio{{ session['paths'].keys().index(filename) }}" value="size" {{ "checked" if cuttingOptions[filename]['cuttingType'] == 'Size' }} data-toggle="radio">
			Segment Size
		</label>
		<label class="radio numberradio">
			<input type="radio" name="radio{{ session['paths'].keys().index(filename) }}" value="number" {{ "checked" if cuttingOptions[filename]['cuttingType'] == 'Number' }} data-toggle="radio">
			Number of Segments
		</label>
	</div>
	<div class="cuttingdiv individcut">
		<div>
			<label class="cuttingoptionslabel inline">{{ 'Segment Size' if cuttingOptions[filename]['cuttingType'] == 'Size' else 'Number of Segments'}}:</label>
			<input class="textinput cuttingValue cuttextinput" 
			name="cuttingValue{{ session['paths'].keys().index(filename) }}" 
			type="text" 
			value="{{ cuttingOptions[filename]['cuttingValue'] }}"/>
			<!-- <img src="{{ url_for('static', filename='question_mark.png') }}" 
			alt="Question Mark" 
			title="Value to segment text by."/> -->
		</div>
		<div>
			<label class="inline">Overlap:</label>
			<input class="textinput cuttextinput"
			name="overlap{{ session['paths'].keys().index(filename) }}" 
			type="text" 
			value="{{ cuttingOptions[filename]['overlap'] }}"/>
			<!-- <img src="{{ url_for('static', filename='question_mark.png') }}"
			alt="Question Mark" 
			title="Number of words to overlap at segment boundaries."/> -->
		</div>
		<div class="lastpropdiv" style="{{ 'opacity:0' if cuttingOptions[filename]['cuttingType'] == 'Number' else '' }}">
			<label class="inline">Last Proportion Threshold:</label>
			<!--  <img src="{{ url_for('static', filename='question_mark.png') }}" 
			alt="Question Mark" 
			title="Minimum proportion of the normal size that the last segment can be."/> -->
			<input {{ "disabled" if cuttingOptions[filename]['cuttingType'] == 'Number' else "" }}
			class="textinput lastpropinput"
			name="lastprop{{ session['paths'].keys().index(filename) }}"
			id="lastprop"
			type="text"
			value="{{ cuttingOptions[filename]['lastProp'] }}"/>
		</div>
	</div>
</div>

<div class="newline">
	{% if session['segmented'] %}
		{% for index, cutpreview in file.items() %}
			{% if loop.index==6 and index > 5 %}
				<p></p>
			{% endif %}

			<fieldset>
			<legend>Segment {{index+1}}</legend>
			{{cutpreview}}
			</fieldset>

		{%- endfor %}

		{% else %}
			{{file}}{{"\u2026"}}
	{% endif %}
</div>

</div>

{%- endfor %}
{% endblock %}