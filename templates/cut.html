{% extends "base.html" %}

{% block head %}
<script type="text/javascript" src="{{ url_for('static', filename='scripts_cut.js') }}"></script>
{% endblock %}


{% block navbar %}
<form id="cut" action="" method="POST" enctype="multipart/form-data" onsubmit="return nocuttingvalue();">
<input class="navbarquarter enabled" id="cutnavbar1" type="submit" name="uploadnav" value="Upload"/>
<input class="navbarquarter enabled" id="cutnavbar2" type="submit" name="scrubnav" value="Scrub"/>
<input disabled class="navbarquarter" id="cutnavbar3" type="submit" name="cutnav" value="Cut"/>
<input class="navbarquarter enabled" id="cutnavbar4" type="submit" name="analyzenav" value="Analyze"/>
{% endblock %}


{% block title %}cutter{% endblock %}
{% block field %}
<legend>Overall Cutting Options</legend>

<div class="cuttingoptionswrapper">
  <div>
    <label class="radio sizeradio" id="sizeradio">
      <input type="radio" name="radio" value="size" {{ "checked" if cuttingOptions['overall']['cuttingType'] == 'Size' }} data-toggle="radio">
      Segment Size
    </label>
    <label class="radio numberradio" id="numberradio">
      <input type="radio" name="radio" value="number" {{ "checked" if cuttingOptions['overall']['cuttingType'] == 'Number' }} data-toggle="radio">
      Number of Segments
    </label>
  </div>


  <div class="cuttingdiv">
		<div id="cuttingsize">
			<label class="cuttingoptionslabel inline">{{ 'Segment Size' if cuttingOptions['overall']['cuttingType'] == 'Size' else 'Number of Segments'}}:</label>
			<input class="textinput cuttingValue cuttextinput" 
			name="cuttingValue" 
			id="overallcutvalue"
			type="text" 
			value="{{ cuttingOptions['overall']['cuttingValue'] }}"/>
			<div class="questionmark cut"></div>
			<div class="tooltip cut">Value to segment text by (e.g. number of segments per text or number of words per segment).</div>
		</div>
		<div>
			<label class="inline">Overlap:</label>
			<input class="textinput cuttextinput"
			name="overlap" 
			type="text" 
			value="{{ cuttingOptions['overall']['overlap'] }}"/>
			<div class="questionmark cut"></div>
			<div class="tooltip cut">Number of words to overlap at segment boundaries.</div>
		</div>
		<div class="lastpropdiv" style="{{ 'opacity:0' if cuttingOptions['overall']['cuttingType'] == 'Number' else '' }}">
			<label class="inline">Last Proportion Threshold:</label>
			<div class="questionmark cut"></div>
			<div class="tooltip cut">Minimum proportion of the given size that the last segment can be.</div>
			<input {{ "disabled" if cuttingOptions['overall']['cuttingType'] == 'Number' else "" }}
			class="textinput lastpropinput"
			name="lastprop"
			id="lastprop"
			type="text"
			value="{{ cuttingOptions['overall']['lastProp'] }}"/>
		</div>
	</div>
</div>
{% endblock %}




{% block submit %}
<input class="btn btn-info" type="submit" value="Cut Files"/>
{% if session['segmented'] %}
<input class="btn btn-success" type="submit" name="dendro" value="Proceed to Analysis"/>
{% endif %}
{% endblock %}




{% block content %}
{% for filename, file in preview.items() | sort %}
<div class="individualpreviewwrapper">

<legend>{{filename}} Preview &nbsp;
<div class="btn indivcutbuttons">Individual Options</div>
</legend>

<div class="cuttingoptionswrapper" style="{{ 'display:none' if cuttingOptions[filename]['cuttingValue'] == '' }}">

	<div>
		<label class="radio sizeradio">
			<input type="radio" name="radio{{ paths[session['id']].keys().index(filename) }}" value="size" {{ "checked" if cuttingOptions[filename]['cuttingType'] == 'Size' }} data-toggle="radio">
			Segment Size
		</label>
		<label class="radio numberradio">
			<input type="radio" name="radio{{ paths[session['id']].keys().index(filename) }}" value="number" {{ "checked" if cuttingOptions[filename]['cuttingType'] == 'Number' }} data-toggle="radio">
			Number of Segments
		</label>
	</div>
	<div class="cuttingdiv individcut">
		<div>
			<label class="cuttingoptionslabel inline">{{ 'Segment Size' if cuttingOptions[filename]['cuttingType'] == 'Size' else 'Number of Segments'}}:</label>
			<input class="textinput cuttingValue cuttextinput" 
			name="cuttingValue{{ paths[session['id']].keys().index(filename) }}" 
			type="text" 
			value="{{ cuttingOptions[filename]['cuttingValue'] }}"/>
			<!-- <div class="questionmark cut"></div>
			<div class="tooltip cut">Value to segment text by (e.g. number of segments per text or number of words per segment).</div> -->
		</div>
		<div>
			<label class="inline">Overlap:</label>
			<input class="textinput cuttextinput"
			name="overlap{{ paths[session['id']].keys().index(filename) }}" 
			type="text" 
			value="{{ cuttingOptions[filename]['overlap'] }}"/>
			<!-- <div class="questionmark cut"></div>
			<div class="tooltip cut">Number of words to overlap at segment boundaries.</div> -->
		</div>
		<div class="lastpropdiv" style="{{ 'opacity:0' if cuttingOptions[filename]['cuttingType'] == 'Number' else '' }}">
			<label class="inline">Last Proportion Threshold:</label>
			<!-- <div class="questionmark cut"></div>
			<div class="tooltip cut">Minimum proportion of the given size that the last segment can be.</div> -->
			<input {{ "disabled" if cuttingOptions[filename]['cuttingType'] == 'Number' else "" }}
			class="textinput lastpropinput"
			name="lastprop{{ paths[session['id']].keys().index(filename) }}"
			id="lastprop"
			type="text"
			value="{{ cuttingOptions[filename]['lastProp'] }}"/>
		</div>
	</div>
</div>

<div class="newline">
	{% if session['segmented'] %}
		{% for index, cutpreview in file.items() %}
			{% if loop.index==6 and index > 5 %}
				<p></p>
			{% endif %}

			<fieldset>
			<legend>Segment {{index+1}}</legend>
			{{cutpreview}}
			</fieldset>

		{%- endfor %}

		{% else %}
			{{file}}{{"\u2026"}}
	{% endif %}
</div>

</div>

{%- endfor %}
{% endblock %}