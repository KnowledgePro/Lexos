{% extends "base_visualize.html" %}
{% set active_page = 'viz' %}


{% block head %}
<script type="text/javascript" src="{{ url_for('static', filename='js/jquery.multiselect.min.js') }}?ver={{version}}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/d3.tip.min.js') }}?ver={{version}}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/scripts_viz.js') }}?ver={{version}}"></script>

<link href="{{ url_for('static', filename='css/jquery.multiselect.css') }}?ver={{version}}" rel="stylesheet">

<script>
	var dataset = {{ JSONObj|safe or {} }};
</script>
{% endblock %}

{% block title %}visualizer{% endblock %}


{% block options %}
{% if loading=='loading' %}<div id="exspecto-bullae">Loading...</div>{% endif %}
<legend>BubbleViz Options</legend>
<div id="vizoptionsbox">
	<legend style="width: 300px;">Select a File</legend>
	{% if labels|len > 0 %}
   		<label><input type="checkbox" id="allCheckBoxSelector">Toggle All</label>
	{%- endif %}
	<div id="vizcreateoptions" name="segmentlist" style="overflow-y: scroll; width: 300px; float: left; max-height: 125px; min-height: 2em;">
		{% for fileID, label in labels.items() %}
			<label>{{label}} 
				<input type="checkbox" name="segmentlist" class="minifilepreview" {{ 'checked' if fileID|unicode in session['cloudoption']['segmentlist'] }} id="{{fileID}}_selector" value="{{fileID}}">
			</label>
		{%- endfor %}
		{% if labels|len == 0 %}
			<span id="no-labels">No Documents are Selected</span>
		{%- endif %}
	</div>
	<div style="position: relative; top: -91px; left: 20px; width: 600px; float: left;">
	<legend>Filtering Options</legend>
	<div class="vizoptions">
		<label>&nbsp;&nbsp;&nbsp;Minimum Word Length:
			<input type="number" min="0" id="minlength" name="minlength" value="{{ session['bubblevisoption']['minlength'] or '0' }}"/>
		</label>
	</div>

	<div class="vizoptions">
		<label>Graph Size:
			<input type="number" min="100" max="3000" step="100" id="graphsize" name="graphsize" value="{{ session['bubblevisoption']['graphsize'] or '800' }}"/>
		</label>
	</div>

	<div class="vizoptions">
		<label>
			<input type="checkbox" class="vizmaxwordsCheckbox" name="vizmaxwords" id="vizmaxwords" {{ "checked" if session['bubblevisoption']['vizmaxwords']}}>Limit Word/Bubble Count
		</label>
	</div>

	<div class="vizoptions">
		<label>
			<span class="vizmaxwordsopt {{ 'hidden' if session['bubblevisoption']["vizmaxwords"] != "on" }}" id="vizmaxwordsopt" name="vizmaxwordsopt">
			&nbsp;&nbsp;&nbsp;Maximum Number of Words:
			<input type="number" min="1" id="maxwords" name="maxwords" value="{{ session['bubblevisoption']['maxwords'] or '1' }}"/>
			</span>
		</label>
	</div>
	</div>
</div>
{% endblock %}

{% block results %}
{% if words == "" %}
<h4 id="nosegments">Please select the segments for the graph.</h4>

{% else %}

<div id="viz"></div>

{% endif %}
{% endblock %}


{% block submit %}
<input class="bttn bttn-action" id="getviz" type="submit" value="Get Graph"/>
<span class="submiterrors" id="vizsubmiterrormessage">No documents selected from actives.</span>
{% endblock %}