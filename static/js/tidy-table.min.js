/**
 *  Tidy Table
 *  Generate a sortable HTML table from JSON
 *
 *  Copyright 2012-2015, Marc S. Brooks (http://mbrooks.info)
 *  Licensed under the MIT license:
 *  http://www.opensource.org/licenses/mit-license.php
 */
if(!window.jQuery||window.jQuery&&parseInt(window.jQuery.fn.jquery.replace(".",""))<parseInt("1.8.3".replace(".","")))throw new Error("Tidy-Table requires jQuery 1.8.3 or greater.");!function(e){function t(e,t){return e>t?1:t>e?-1:0}function n(e,t){return t-e}var o={init:function(t,n){var o=e(this),r=o.data(),a={enableCheckbox:!1,enableMenu:!1,reverseSortDir:!1,responsive:!1};return arguments.length>1?e.extend(a,t):n=t,n=e.extend({sortByPattern:function(t,n){return e.trim(t)?String(n).replace(/$|%|#/g,""):void 0}},n),e.isEmptyObject(r)&&o.data({settings:a,config:n}),a.responsive&&o.addClass("tidy_table media"),o.TidyTable("_createTable")},destroy:function(){e(this).removeData()},_createTable:function(t,n){var o=e(this),r=o.data(),a=e("<table></table>").addClass("tidy_table");a.mousedown(function(){return!1}),a.mouseover(function(){return!1});var c=e("<thead></thead>"),s=e("<tbody></tbody>"),i=null;!function(){i=r.config.columnTitles;for(var a=e("<tr></tr>"),s=0;s<i.length;s++){var d=i[s],l=e("<th></th>").append(d).attr("title",d);a.append(l);var u;r.settings.reverseSortDir?"desc"!=n&&n?(u="sort_desc",l.order="desc"):(u="sort_asc",l.order="asc"):"asc"!=n&&n?(u="sort_desc",l.order="asc"):(u="sort_asc",l.order="desc"),t==s&&l.addClass(u),l.on("click",{col_number:s,sort_order:t==s?l.order:"asc"},function(e){o.TidyTable("_sortByColumn",e.data.col_number,e.data.sort_order)})}c.append(a)}(),function(){for(var t=r.config.columnValues,n=0;n<t.length;n++){for(var i=e("<tr></tr>"),d=0;d<t[n].length;d++){var l=decodeURIComponent(escape(t[n][d])),u=e("<td></td>").append(l).attr("title",l);i.append(u),r.config.postProcess&&e.isFunction(r.config.postProcess.column)&&r.config.postProcess.column(u)}s.append(i)}if(a.append(c),a.append(s),r.settings&&r.settings.enableCheckbox){var f=a.find("tr");f.each(function(t){var n,r=e("<input></input>").attr("type","checkbox");0===t?(n=e("<th></th>"),r.on("click",function(){o.TidyTable("_toggleSelRows",f)})):(n=e("<td></td>"),r.on("click",{box_number:t},function(e){o.TidyTable("_toggleSelRows",f,e.data.box_number)})),n.append(r),e(this).prepend(n)})}}(),r.config.postProcess&&e.isFunction(r.config.postProcess.table)&&r.config.postProcess.table(a);var d=o.children("table.tidy_table");return d[0]?d.replaceWith(a):(r.settings&&r.settings.enableMenu&&o.append(o.TidyTable("_createMenu",a,"options")),o.append(a)),a},_createMenu:function(t,n){var o=e(this),r=o.data(),a=e("<select></select>").addClass("tidy_table "+n).change(function(){var n=e(this),a=r.config.menuOptions[n.val()][1].callback;e.isFunction(a)&&a(o.TidyTable("_getCheckedAsObj",t)),n.val(0)});return e.each(r.config.menuOptions,function(t){var n=e("<option>"+r.config.menuOptions[t][0]+"</option>").attr("value",t);a.append(n)}),r.config.postProcess&&e.isFunction(r.config.postProcess.menu)&&r.config.postProcess.menu(a),a},_getCheckedAsObj:function(e){for(var t=e.find("tbody > tr"),n=[],o=0;o<t.length;o++){var r=t[o].childNodes;if(r[0].firstChild.checked){for(var a=[],c=1;c<r.length;c++)a[c-1]=r[c].textContent;n.push(a)}}return n},_toggleSelRows:function(t,n){var o=null;t.each(function(t){var r=e(this),a=r.find(":checkbox").first();if(n){if(0===t)return;a.is(":checked")?(r.removeClass("check_off").addClass("check_on"),a.prop("checked",!0)):(r.removeClass("check_on").addClass("check_off"),a.prop("checked",!1))}else{if(0===t)return void(o=a.is(":checked")?!0:!1);o?(r.removeClass("check_off").addClass("check_on"),a.prop("checked",!0)):(r.removeClass("check_on").addClass("check_off"),a.prop("checked",!1))}})},_sortByColumn:function(o,r){var a=e(this),c=a.data();if(e.isFunction(c.config.sortByPattern)){var s="desc"==r?-1:1;c.config.columnValues.sort(function(e,r){var a=c.config.sortByPattern(o,e[o]),i=c.config.sortByPattern(o,r[o]);return isNaN(a)?[s*t(a,i)]>[s*t(i,a)]?-1:1:[s*n(a,i)]})}a.TidyTable("_createTable",o,r)}};e.fn.TidyTable=function(t){return o[t]?o[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist in jQuery.TidyTable"):o.init.apply(this,arguments)}}(jQuery);